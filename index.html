<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>C·∫∑p l·ªìng gi·ªØ nhi·ªát Kela ƒê·ª©c 1,2L</title>
  <meta name="format-detection" content="telephone=no">
  <style>
    :root{
      --red:#ff4d4d;
      --black:#000;
      --muted:#666;
      --card:#ffffff;
      --bg:#ffffff;
      --shadow:0 6px 24px rgba(0,0,0,.08);
      --radius:16px;
      --container:1200px;
      --reading:960px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    html{scroll-behavior:smooth; overscroll-behavior-y:contain;}
    /* Body scroll vertical only by default */
    body{margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; color:var(--black); background:var(--bg); touch-action: pan-y;}
    a{color:inherit; text-decoration:none}
    img{display:block; max-width:100%}
    .container{max-width:var(--container); margin:0 auto; padding:20px}
    .reading{max-width:var(--reading); margin:0 auto; padding:0 20px}
    h1{font-size:42px; line-height:1.15; margin:0 0 8px}
    h2{font-size:28px; margin:0 0 12px}
    h3{font-size:22px; margin:0 0 8px}
    p{margin:0 0 12px; line-height:1.65}
    .price{font-size:22px; color:var(--red); font-weight:700}
    .old{color:#888; text-decoration:line-through; margin-left:8px}
    .usp-quick{color:#333; font-size:14px}
    .btn{appearance:none; border:0; background:var(--red); color:#fff; padding:14px 22px; border-radius:999px; font-weight:700; box-shadow:var(--shadow); cursor:pointer}
    .btn:active{transform:translateY(1px)}
    .muted{color:var(--muted)}
    /* HERO */
    .hero{display:grid; grid-template-columns:1fr; gap:28px; align-items:center}
    @media(min-width:980px){ .hero{grid-template-columns:1fr 1fr;} }
    .hero-media{position:relative;}
    .hero-frame{position:relative; width:100%; aspect-ratio:1/1; border-radius:var(--radius); overflow:hidden; background:#f8f8f8; box-shadow:var(--shadow)}
    .hero-track{display:flex; height:100%; transition:transform .35s ease; will-change:transform}
    .hero-slide{flex:0 0 100%; height:100%;}
    .hero-slide img{width:100%; height:100%; object-fit:cover;}
    .hero-counter{position:absolute; right:12px; bottom:12px; background:rgba(0,0,0,.6); color:#fff; padding:6px 10px; border-radius:999px; font-size:12px}
    .thumbs{display:flex; gap:10px; margin-top:12px; overflow-x:auto; padding-bottom:6px}
    .thumb{flex:0 0 auto; width:66px; height:66px; border-radius:12px; overflow:hidden; border:2px solid transparent; cursor:pointer}
    .thumb.active{border-color:var(--red)}
    .thumb img{width:100%; height:100%; object-fit:cover}
    .hero-info .cta-row{display:flex; gap:14px; align-items:center; flex-wrap:wrap}
    .countdown{color:var(--red); font-weight:700; font-size:14px}
    /* Sticky CTA on mobile */
    .sticky-cta{position:fixed; left:0; right:0; bottom:env(safe-area-inset-bottom); background:rgba(255,255,255,.85); backdrop-filter:saturate(180%) blur(8px); padding:10px 16px; z-index:40; display:none}
    .sticky-cta .btn{width:100%}
    @media(max-width:980px){ .sticky-cta{display:block} }
    /* DESCRIPTION (stacked) */
    .desc{padding:36px 0}
    .desc-item{max-width:var(--reading); margin:0 auto 36px; text-align:center}
    .desc-item .pic{margin:12px auto 0; width:100%; max-width:720px; aspect-ratio:1/1; border-radius:20px; overflow:hidden; box-shadow:var(--shadow)}
    .desc-item .pic img{width:100%; height:100%; object-fit:cover}
    /* REVIEWS */
    .reviews{padding:44px 0; background:#fafafa}
    .review-head{max-width:var(--reading); margin:0 auto 16px; padding:0 20px}
    .carousel{position:relative}
    .car-viewport{overflow:hidden}
    .car-track{display:flex; gap:16px; padding:6px 4px; will-change:transform; transition:transform .35s ease}
    .card{flex:0 0 86%; max-width:340px; background:#fff; border-radius:16px; box-shadow:var(--shadow); padding:16px}
    .card .who{display:flex; gap:10px; align-items:center; margin-bottom:6px}
    .card .who img{width:46px; height:46px; border-radius:50%; object-fit:cover}
    @media(min-width:980px){
      .card{flex:0 0 calc((var(--container) - 80px)/3); max-width:none}
    }
    .arrow{position:absolute; top:50%; transform:translateY(-50%); width:36px; height:36px; border-radius:999px; background:#fff; box-shadow:var(--shadow); display:grid; place-items:center; cursor:pointer; user-select:none}
    .arrow.left{left:8px} .arrow.right{right:8px}
    /* FAQ */
    .faq{max-width:var(--reading); margin:44px auto; padding:0 20px}
    .accordion{border-top:1px solid #eee}
    .q{border-bottom:1px solid #eee; padding:14px 0; cursor:pointer; display:flex; gap:10px; align-items:flex-start}
    .q .icon{font-size:18px} .a{display:none; padding:6px 0 12px; color:#333}
    .q.open + .a{display:block}
    /* FOOTER */
    .footer{background:#f8f8f8; padding:28px 20px; margin-top:32px}
    .footer .usp{display:flex; gap:16px; flex-wrap:wrap; justify-content:center}
    .footer .usp .pill{background:#fff; border-radius:999px; padding:10px 14px; box-shadow:var(--shadow)}
    .footer .grid{display:grid; gap:20px; max-width:var(--container); margin:16px auto 0}
    @media(min-width:900px){ .footer .grid{grid-template-columns:1fr 1fr} }
    /* MODAL */
    .modal{position:fixed; inset:0; background:rgba(0,0,0,.6); display:none; align-items:center; justify-content:center; z-index:100}
    .modal.open{display:flex}
    .sheet{background:#fff; border-radius:16px; width:min(92vw,420px); max-height:90vh; overflow:auto; padding:18px 18px 22px; position:relative}
    .close{position:absolute; right:10px; top:10px; font-size:22px; cursor:pointer; line-height:1}
    .form input, .form select, .form textarea{width:100%; padding:12px 14px; border:1px solid #ddd; border-radius:10px; margin:6px 0 12px; font-size:16px}
    .form button{width:100%}
    .thanks{display:none; text-align:center; color:#16a34a; font-weight:700; padding:8px 0}
    /* Scroll lock helper */
    .no-scroll{overflow:hidden; height:100%}
    /* Prevent whole-page horizontal pan while keep vertical */
    #app{touch-action:pan-y}
    /* Slider zones allow horizontal pan */
    .pan-x{touch-action:pan-x}
  </style>
</head>
<body>
<div id="app">
  <header class="container hero">
    <!-- MEDIA -->
    <div class="hero-media">
      <div class="hero-frame pan-x" id="heroFrame">
        <div class="hero-track" id="heroTrack">
          <div class="hero-slide"><img src="assets/1.png" alt="S·∫£n ph·∫©m 1"></div>
          <div class="hero-slide"><img src="assets/2.png" alt="S·∫£n ph·∫©m 2"></div>
          <div class="hero-slide"><img src="assets/3.png" alt="S·∫£n ph·∫©m 3"></div>
          <div class="hero-slide"><img src="assets/4.png" alt="S·∫£n ph·∫©m 4"></div>
          <div class="hero-slide"><img src="assets/5.png" alt="S·∫£n ph·∫©m 5"></div>
          <div class="hero-slide"><img src="assets/6.png" alt="S·∫£n ph·∫©m 6"></div>
        </div>
        <div class="hero-counter" id="heroCounter">1/6</div>
      </div>
      <div class="thumbs" id="thumbs">
        <div class="thumb active"><img src="assets/1.png" alt=""></div>
        <div class="thumb"><img src="assets/2.png" alt=""></div>
        <div class="thumb"><img src="assets/3.png" alt=""></div>
        <div class="thumb"><img src="assets/4.png" alt=""></div>
        <div class="thumb"><img src="assets/5.png" alt=""></div>
        <div class="thumb"><img src="assets/6.png" alt=""></div>
      </div>
    </div>
    <!-- INFO -->
    <div class="hero-info">
      <h1>C·∫∑p l·ªìng gi·ªØ nhi·ªát Kela ƒê·ª©c 1,2L</h1>
      <div class="price-row"><span class="price">350.000ƒë</span><span class="old">870.000ƒë</span></div>
      <p class="usp-quick">SALE 60% h√¥m nay ‚Äì S·ªë l∆∞·ª£ng c√≥ h·∫°n | Freeship to√†n qu·ªëc | ƒê·ªïi tr·∫£ 3 ng√†y | H√†ng ch√≠nh h√£ng</p>
      <div class="cta-row">
        <button class="btn" id="buyBtnTop">MUA NGAY ‚Äì Gi·∫£m 60%</button>
        <span class="countdown">∆Øu ƒë√£i k·∫øt th√∫c sau: <span id="cd">30:00</span></span>
      </div>
    </div>
  </header>

  <!-- Sticky CTA mobile -->
  <div class="sticky-cta">
    <button class="btn" id="buyBtnSticky">MUA NGAY ‚Äì Gi·∫£m 60%</button>
  </div>

  <!-- DESCRIPTION stacked -->
  <section class="desc reading" id="desc">
    <article class="desc-item">
      <h2>üî• Gi·ªØ nhi·ªát v∆∞·ª£t tr·ªôi c·∫£ ng√†y</h2>
      <p>Nh·ªù c√¥ng ngh·ªá ch√¢n kh√¥ng 2 l·ªõp, c·∫∑p l·ªìng Kela gi√∫p c∆°m canh <b>lu√¥n n√≥ng h·ªïi ƒë·∫øn tr∆∞a</b>, ƒë·ªìng th·ªùi <b>gi·ªØ l·∫°nh hi·ªáu qu·∫£ nhi·ªÅu gi·ªù</b>, mang ƒë·∫øn tr·∫£i nghi·ªám ti·ªán l·ª£i cho c·∫£ gia ƒë√¨nh.</p>
      <div class="pic"><img src="assets/1.png" alt="Gi·ªØ nhi·ªát v∆∞·ª£t tr·ªôi"></div>
    </article>

    <article class="desc-item">
      <h2>üõ°Ô∏è Ch·∫•t li·ªáu Inox 304 cao c·∫•p</h2>
      <p>C·∫∑p l·ªìng gi·ªØ nhi·ªát Kela ƒë∆∞·ª£c l√†m t·ª´ <b>th√©p kh√¥ng g·ªâ 304</b>, an to√†n cho s·ª©c kh·ªèe, ch·ªëng g·ªâ s√©t, b·ªÅn ƒë·∫πp theo th·ªùi gian.</p>
      <div class="pic"><img src="assets/2.png" alt="Inox 304 cao c·∫•p"></div>
    </article>

    <article class="desc-item">
      <h2>üëå Thi·∫øt k·∫ø g·ªçn g√†ng ‚Äì Ti·ªán l·ª£i</h2>
      <p>Thi·∫øt k·∫ø nh·ªè g·ªçn, d·ªÖ mang theo ƒëi l√†m, ƒëi h·ªçc hay picnic. C√≥ <b>ngƒÉn th√¨a inox g·∫•p g·ªçn trong n·∫Øp</b>, s·∫°ch s·∫Ω ‚Äì ti·ªán d·ª•ng m·ªçi l√∫c.</p>
      <div class="pic"><img src="assets/3.png" alt="Thi·∫øt k·∫ø ti·ªán l·ª£i"></div>
    </article>
  </section>

  <!-- REVIEWS -->
  <section class="reviews">
    <div class="review-head">
      <h2>‚ú® Tr·∫£i nghi·ªám th·ª±c t·∫ø t·ª´ kh√°ch h√†ng</h2>
    </div>
    <div class="container carousel">
      <div class="arrow left" id="revPrev">‚Äπ</div>
      <div class="arrow right" id="revNext">‚Ä∫</div>
      <div class="car-viewport pan-x" id="revViewport">
        <div class="car-track" id="revTrack">
          <div class="card">
            <div class="who"><img src="assets/1.png" alt=""><div><b>Nguy·ªÖn Th·∫£o</b><div class="muted">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div></div></div>
            <p>C∆°m mang t·ª´ s√°ng ƒë·∫øn tr∆∞a v·∫´n n√≥ng h·ªïi. Thi·∫øt k·∫ø g·ªçn, b·ªè balo kh√¥ng lo ƒë·ªï.</p>
          </div>
          <div class="card">
            <div class="who"><img src="assets/3.png" alt=""><div><b>Thu H√†</b><div class="muted">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div></div></div>
            <p>H·ªôp gi·ªØ n√≥ng c·∫£ bu·ªïi, b√© ƒÉn ngon h∆°n. Inox 304 an to√†n n√™n y√™n t√¢m.</p>
          </div>
          <div class="card">
            <div class="who"><img src="assets/6.png" alt=""><div><b>Minh Khoa</b><div class="muted">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div></div></div>
            <p>S·∫£n ph·∫©m ch·∫Øc ch·∫Øn, gi·ªØ nhi·ªát c·ª±c t·ªët. Giao h√†ng nhanh v√† ƒë√≥ng g√≥i c·∫©n th·∫≠n.</p>
          </div>
          <div class="card">
            <div class="who"><img src="assets/2.png" alt=""><div><b>H·ªìng Nhung</b><div class="muted">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div></div></div>
            <p>Mua 2 l√†m qu√† r·∫•t v·ª´a √Ω, m√†u s·∫Øc ƒë·∫πp, c·∫ßm ch·∫Øc tay.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section class="faq" id="faq">
    <h2>C√¢u h·ªèi th∆∞·ªùng g·∫∑p</h2>
    <div class="accordion">
      <div class="q"><span class="icon">‚ùì</span><div><b>H·ªôp gi·ªØ n√≥ng ƒë∆∞·ª£c bao l√¢u?</b></div></div>
      <div class="a">Kela gi·ªØ n√≥ng 4‚Äì6 gi·ªù v√† gi·ªØ l·∫°nh 6‚Äì8 gi·ªù nh·ªù c√¥ng ngh·ªá ch√¢n kh√¥ng 2 l·ªõp.</div>

      <div class="q"><span class="icon">‚ùì</span><div><b>C√≥ b·ªã tr√†n khi ƒë·ªÉ trong balo?</b></div></div>
      <div class="a">Kh√¥ng. N·∫Øp kh√≥a k√≠n v√† ron ch·ªëng tr√†n gi√∫p b·∫°n y√™n t√¢m khi di chuy·ªÉn.</div>

      <div class="q"><span class="icon">‚ùì</span><div><b>C√≥ k√®m th√¨a kh√¥ng?</b></div></div>
      <div class="a">C√≥. ƒêi k√®m l√† th√¨a inox g·∫•p g·ªçn trong n·∫Øp, s·∫°ch s·∫Ω v√† ti·ªán l·ª£i.</div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="usp">
      <div class="pill">üöö Freeship to√†n qu·ªëc</div>
      <div class="pill">üîÑ ƒê·ªïi tr·∫£ 3 ng√†y</div>
      <div class="pill">üõ°Ô∏è H√†ng ch√≠nh h√£ng</div>
      <div class="pill">‚òéÔ∏è H·ªó tr·ª£ 24/7</div>
    </div>
    <div class="grid">
      <div>
        <h3>V·ªÅ Kela</h3>
        <p>Ch√∫ng t√¥i tin r·∫±ng m·ªôt s·∫£n ph·∫©m t·ªët kh√¥ng ch·ªâ ti·ªán l·ª£i m√† c√≤n mang l·∫°i s·ª± an t√¢m cho s·ª©c kh·ªèe c·∫£ gia ƒë√¨nh.</p>
      </div>
      <div>
        <h3>Li√™n h·ªá</h3>
        <p>üìç 2b V∆∞∆°ng Th·ª´a V≈©</p>
        <p>‚òéÔ∏è 0915593392</p>
        <p>‚úâÔ∏è stgd@gmail.com</p>
      </div>
    </div>
  </footer>
</div>

<!-- ORDER MODAL -->
<div class="modal" id="orderModal" aria-hidden="true">
  <div class="sheet">
    <div class="close" id="closeModal" aria-label="ƒê√≥ng">√ó</div>
    <h3>Th√¥ng tin ƒë·∫∑t h√†ng</h3>
    <form class="form" id="orderForm" novalidate>
      <select name="mau" required>
        <option value="">Ch·ªçn m√†u</option>
        <option>Inox</option>
        <option>H·ªìng</option>
      </select>
      <select name="combo" required>
        <option value="">Ch·ªçn combo</option>
        <option>Mua 1 ‚Äì 350K</option>
        <option>Mua 2 ‚Äì 650K</option>
      </select>
      <input type="text" name="hoten" placeholder="H·ªç t√™n *" required>
      <input type="tel" name="sdt" placeholder="S·ªë ƒëi·ªán tho·∫°i *" inputmode="numeric" pattern="0[0-9]{9}" required>
      <input type="text" name="diachi" placeholder="ƒê·ªãa ch·ªâ *" required>
      <textarea name="ghichu" placeholder="Ghi ch√∫" rows="3"></textarea>
      <button type="submit" class="btn">X√°c nh·∫≠n ƒë·∫∑t h√†ng</button>
      <div class="thanks" id="thanks">‚úÖ C·∫£m ∆°n b·∫°n ƒë√£ ƒë·∫∑t h√†ng! Nh√¢n vi√™n s·∫Ω li√™n h·ªá x√°c nh·∫≠n ƒë∆°n h√†ng trong th·ªùi gian s·ªõm nh·∫•t.</div>
    </form>
  </div>
</div>

<script>
  /* ---------- COUNTDOWN 30' ---------- */
  (function(){
    const el = document.getElementById('cd');
    let total = 30*60; // seconds
    function tick(){
      const m = Math.floor(total/60).toString().padStart(2,'0');
      const s = (total%60).toString().padStart(2,'0');
      el.textContent = m+':'+s;
      if(total>0) total--;
    }
    tick(); setInterval(tick,1000);
  })();

  /* ---------- Modal ---------- */
  const modal = document.getElementById('orderModal');
  const closeBtn = document.getElementById('closeModal');
  document.getElementById('buyBtnTop').onclick = openModal;
  document.getElementById('buyBtnSticky').onclick = openModal;
  function openModal(){ modal.classList.add('open'); document.body.classList.add('no-scroll'); }
  function closeModal(){ modal.classList.remove('open'); document.body.classList.remove('no-scroll'); }
  closeBtn.addEventListener('click', closeModal);
  modal.addEventListener('click', (e)=>{ if(e.target===modal) closeModal(); });

  /* ---------- FAQ ---------- */
  document.querySelectorAll('.accordion .q').forEach(q=>{
    q.addEventListener('click', ()=>{
      q.classList.toggle('open');
      const next = q.nextElementSibling;
      if(next && next.classList.contains('a')){
        next.style.display = next.style.display==='block' ? 'none' : 'block';
      }
    });
  });

  /* ---------- Hero slider (drag/swipe with momentum-like feel) ---------- */
  const heroTrack = document.getElementById('heroTrack');
  const heroFrame = document.getElementById('heroFrame');
  const thumbs = Array.from(document.querySelectorAll('.thumb'));
  const heroCounter = document.getElementById('heroCounter');
  let idx = 0, startX=0, startY=0, isDown=false, curX=0, lockScroll=false;

  function updateHero(){
    heroTrack.style.transition = 'transform .35s ease';
    heroTrack.style.transform = `translateX(${-idx*100}%)`;
    thumbs.forEach((t,i)=> t.classList.toggle('active', i===idx));
    heroCounter.textContent = (idx+1)+'/6';
  }
  updateHero();
  function onStart(e){
    isDown=true; heroTrack.style.transition='none';
    const p = ('touches' in e)? e.touches[0] : e;
    startX = p.clientX; startY=p.clientY; curX=startX; lockScroll=false;
  }
  function onMove(e){
    if(!isDown) return;
    const p = ('touches' in e)? e.touches[0] : e;
    const dx = p.clientX - startX;
    const dy = p.clientY - startY;
    if(Math.abs(dx) > Math.abs(dy)){ // horizontal intent
      // prevent body vertical scroll while swiping slider
      if('touches' in e){ e.preventDefault(); }
      lockScroll=true;
      const w = heroFrame.clientWidth;
      heroTrack.style.transform = `translateX(${(-idx*w + dx)}px)`;
    }
    curX = p.clientX;
  }
  function onEnd(){
    if(!isDown) return; isDown=false;
    const dx = curX - startX;
    const w = heroFrame.clientWidth;
    const threshold = w*0.18;
    if(dx > threshold && idx>0) idx--;
    else if(dx < -threshold && idx < 5) idx++;
    updateHero();
  }
  ['mousedown','touchstart'].forEach(ev=>heroFrame.addEventListener(ev,onStart,{passive:false}));
  ['mousemove','touchmove'].forEach(ev=>heroFrame.addEventListener(ev,onMove,{passive:false}));
  ['mouseup','mouseleave','touchend','touchcancel'].forEach(ev=>heroFrame.addEventListener(ev,onEnd));

  thumbs.forEach((t,i)=> t.addEventListener('click', ()=>{ idx=i; updateHero(); }));

  /* ---------- Review slider ---------- */
  const revTrack = document.getElementById('revTrack');
  const revViewport = document.getElementById('revViewport');
  const revPrev = document.getElementById('revPrev');
  const revNext = document.getElementById('revNext');
  let revX0=0, revCur=0, revDown=false, revIndex=0;
  const step = ()=>{
    const vw = revViewport.clientWidth;
    revTrack.style.transition='.35s ease';
    revTrack.style.transform = `translateX(${-revIndex*(vw>980? (vw/3) : (vw*0.9))}px)`;
  };
  function revStart(e){
    revDown=true; revTrack.style.transition='none';
    const p=('touches'in e)?e.touches[0]:e; revX0 = p.clientX; revCur=revX0;
  }
  function revMove(e){
    if(!revDown) return;
    const p=('touches'in e)?e.touches[0]:e; const dx=p.clientX-revX0;
    if('touches'in e){ e.preventDefault(); }
    revCur=p.clientX;
    const vw = revViewport.clientWidth;
    const base = -revIndex*(vw>980? (vw/3) : (vw*0.9));
    revTrack.style.transform=`translateX(${base+dx}px)`;
  }
  function revEnd(){
    if(!revDown) return; revDown=false;
    const dx=revCur-revX0; const vw = revViewport.clientWidth; const th = vw*0.15;
    const maxIndex = 3; // simple bound
    if(dx<-th && revIndex<maxIndex) revIndex++;
    else if(dx>th && revIndex>0) revIndex--;
    step();
  }
  ['mousedown','touchstart'].forEach(ev=>revViewport.addEventListener(ev,revStart,{passive:false}));
  ['mousemove','touchmove'].forEach(ev=>revViewport.addEventListener(ev,revMove,{passive:false}));
  ['mouseup','mouseleave','touchend','touchcancel'].forEach(ev=>revViewport.addEventListener(ev,revEnd));
  revPrev.addEventListener('click', ()=>{ if(revIndex>0){revIndex--; step();}});
  revNext.addEventListener('click', ()=>{ revIndex++; step();});

  /* ---------- Lock body scroll to vertical while allowing horizontal inside sliders ---------- */
  // Already handled via CSS touch-action + preventDefault during horizontal drags above.

  /* ---------- Form submit to Apps Script (keep leading zero) ---------- */
  const form = document.getElementById('orderForm');
  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const fd = new FormData(form);
    // Build payload and keep phone as string with leading zero; also prefix with ' to force Sheets text
    const payload = {
      hoten: (fd.get('hoten')||'').toString(),
      sdt: ("'" + (fd.get('sdt')||'').toString()), // preserve leading zero in Google Sheets
      diachi: (fd.get('diachi')||'').toString(),
      ghichu: (fd.get('ghichu')||'').toString(),
      mau: (fd.get('mau')||'').toString(),
      combo: (fd.get('combo')||'').toString()
    };
    const url = "https://script.google.com/macros/s/AKfycbwch0w8Rz-F8MhOa79B3sS8pDKGt0bt4U0ZhA1xwFs2vCctSWaVwgBgD4jgkQlsgWDPUQ/exec";
    try{
      const res = await fetch(url, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify(payload)
      });
      const txt = await res.text();
      // If CORS blocks reading, still show thanks
      document.getElementById('thanks').style.display='block';
      setTimeout(()=>{ closeModal(); form.reset(); document.getElementById('thanks').style.display='none'; }, 3500);
    }catch(err){
      // Fallback no-cors
      try{
        await fetch(url, { method:'POST', mode:'no-cors', body: JSON.stringify(payload) });
      }catch(_e){}
      document.getElementById('thanks').style.display='block';
      setTimeout(()=>{ closeModal(); form.reset(); document.getElementById('thanks').style.display='none'; }, 3500);
    }
  });
</script>
</body>
</html>
